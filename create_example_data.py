import io
import pandas as pd

def format_naics(naics_temp):
    return str(int(naics_temp))

def format_descr(descr_temp):
    return str(descr_temp).upper().strip()

def format_weight(weight_base, dup):
    return str(weight_base/dup)

def get_sector(naics):
    sector = naics[:2]
    # Manufacturing
    if sector in ("32", "33"):
        return "31"
    # Retail Trade
    elif sector == "45":
        return "44"
    # Transportation and Warehousing
    elif sector == "49":
        return "48"
    return sector

def main():
    print("Purpose:  Create pipe-delimited example dataset using publicly available 2017 NAICS files")
    print("          Create pipe-delimited example dataset using publicly available 2022 NAICS files")
    print("")
    print("Note:     Download the following files before running this program")
    print("")
    print("Sources:  https://www.census.gov/naics/2017NAICS/2017_NAICS_Index_File.xlsx")
    print("          https://www.census.gov/naics/2022NAICS/2022_NAICS_Index_File.xlsx")
    print("          https://www.census.gov/naics/2017NAICS/6-digit_2017_Codes.xlsx")
    print("          https://www.census.gov/naics/2022NAICS/6-digit_2022_Codes.xlsx")
    print("")

    # 2017 data WITH sample weights
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@    2017 data WITH sample weights    @@@@")
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("")

    index17_df = pd.read_excel("2017_NAICS_Index_File.xlsx")
    index17_tups = []
    for i in range(len(index17_df)):
        naics_temp = index17_df.at[i, "NAICS17"]
        descr_temp = index17_df.at[i, "INDEX ITEM DESCRIPTION"]
        if not (pd.isna(naics_temp) or naics_temp == "******" or pd.isna(descr_temp)):
            index17_tups.append((format_naics(naics_temp), format_descr(descr_temp)))

    codes17_df = pd.read_excel("6-digit_2017_Codes.xlsx")
    codes17_tups = []
    for i in range(len(codes17_df)):
        naics_temp = codes17_df.at[i, "2017 NAICS Code"]
        descr_temp = codes17_df.at[i, "2017 NAICS Title"]
        if not (pd.isna(naics_temp) or pd.isna(descr_temp)):
            codes17_tups.append((format_naics(naics_temp), format_descr(descr_temp)))

    combined17_tups = sorted(set(index17_tups + codes17_tups))

    print("The sample weights are for illustration only and are based loosely on the number of")
    print("    establishments in each 6-digit NAICS code according to the 2017 Economic Census")
    print("    (Source: EC1700BASIC table; available at https://data.census.gov)")
    print("")

    weights17 = {
        "111110": 1626.46,
        "111120": 361.44,
        "111130": 464.7,
        "111140": 1626.46,
        "111150": 1084.3,
        "111160": 1626.46,
        "111191": 1626.46,
        "111199": 361.44,
        "111211": 542.16,
        "111219": 47.84,
        "111310": 3252.92,
        "111320": 406.62,
        "111331": 3252.92,
        "111332": 1084.3,
        "111333": 3252.92,
        "111334": 271.08,
        "111335": 325.3,
        "111336": 3252.92,
        "111339": 112.16,
        "111411": 813.22,
        "111419": 154.9,
        "111421": 171.2,
        "111422": 216.86,
        "111910": 1626.46,
        "111920": 1084.3,
        "111930": 1084.3,
        "111940": 542.16,
        "111991": 3252.92,
        "111992": 3252.92,
        "111998": 108.44,
        "112111": 325.3,
        "112112": 542.16,
        "112120": 813.22,
        "112130": 3252.92,
        "112210": 361.44,
        "112310": 464.7,
        "112320": 542.16,
        "112330": 1084.3,
        "112340": 650.58,
        "112390": 295.72,
        "112410": 542.16,
        "112420": 542.16,
        "112511": 232.36,
        "112512": 271.08,
        "112519": 361.44,
        "112910": 406.62,
        "112920": 542.16,
        "112930": 542.16,
        "112990": 147.86,
        "113110": 3252.92,
        "113210": 135.54,
        "113310": 295.72,
        "114111": 83.4,
        "114112": 232.36,
        "114119": 542.16,
        "114210": 464.7,
        "115111": 1626.46,
        "115112": 108.44,
        "115113": 232.36,
        "115114": 75.64,
        "115115": 650.58,
        "115116": 1626.46,
        "115210": 108.44,
        "115310": 271.08,
        "211120": 548.02,
        "211130": 128.52,
        "212111": 150.84,
        "212112": 514.96,
        "212113": 223.48,
        "212210": 205.12,
        "212221": 290.44,
        "212222": 817.28,
        "212230": 124.1,
        "212291": 271.08,
        "212299": 50.82,
        "212311": 116.76,
        "212312": 315.82,
        "212313": 460.4,
        "212319": 140.96,
        "212321": 696.14,
        "212322": 234.88,
        "212324": 366.46,
        "212325": 94.08,
        "212391": 117.1,
        "212392": 544.58,
        "212393": 100.34,
        "212399": 40.32,
        "213111": 318.42,
        "213112": 153.02,
        "213113": 133.3,
        "213114": 197.96,
        "213115": 223.36,
        "221111": 1338.14,
        "221112": 1785.32,
        "221113": 1175.86,
        "221114": 892.7,
        "221115": 1307.48,
        "221116": 1102.58,
        "221117": 1158.22,
        "221118": 1103.64,
        "221121": 917.54,
        "221122": 2431.94,
        "221210": 437.78,
        "221310": 668.36,
        "221320": 693.02,
        "221330": 246.44,
        "236115": 955.26,
        "236116": 392.14,
        "236117": 384.66,
        "236118": 1142.9,
        "236210": 144.3,
        "236220": 206,
        "237110": 349.76,
        "237120": 233.7,
        "237130": 279.16,
        "237210": 658.06,
        "237310": 273.1,
        "237990": 96.88,
        "238110": 947.22,
        "238120": 434.96,
        "238130": 719.26,
        "238140": 681.02,
        "238150": 707.72,
        "238160": 863.52,
        "238170": 742.8,
        "238190": 379.52,
        "238210": 586.54,
        "238220": 425.86,
        "238290": 196.22,
        "238310": 386.82,
        "238320": 1228.02,
        "238330": 892.16,
        "238340": 890.32,
        "238350": 581.38,
        "238390": 302.32,
        "238910": 321.8,
        "238990": 380.26,
        "311111": 319.24,
        "311119": 117.34,
        "311211": 107.38,
        "311212": 211.28,
        "311213": 276.98,
        "311221": 116.24,
        "311224": 126.1,
        "311225": 136.46,
        "311230": 199.32,
        "311313": 206.24,
        "311314": 166.82,
        "311340": 129.5,
        "311351": 198.3,
        "311352": 297.2,
        "311411": 238.06,
        "311412": 180.84,
        "311421": 105.14,
        "311422": 172.2,
        "311423": 180.46,
        "311511": 130.16,
        "311512": 666.64,
        "311513": 338.9,
        "311514": 100.92,
        "311520": 241.84,
        "311611": 172.76,
        "311612": 144.1,
        "311613": 238.64,
        "311615": 160.52,
        "311710": 144.74,
        "311811": 4575.52,
        "311812": 312.08,
        "311813": 327.44,
        "311821": 381.58,
        "311824": 161.46,
        "311830": 1914.12,
        "311911": 455.7,
        "311919": 429.34,
        "311920": 237.14,
        "311930": 268.8,
        "311941": 199.96,
        "311942": 161.52,
        "311991": 243.54,
        "311999": 117.98,
        "312111": 213.08,
        "312112": 740.06,
        "312113": 1282.96,
        "312120": 611.5,
        "312130": 336.14,
        "312140": 334.12,
        "312230": 250.9,
        "313110": 58.72,
        "313210": 75.6,
        "313220": 92.84,
        "313230": 180.16,
        "313240": 128.8,
        "313310": 113.72,
        "313320": 175.56,
        "314110": 455.34,
        "314120": 264.68,
        "314910": 240.76,
        "314994": 316.16,
        "314999": 103.3,
        "315110": 143.96,
        "315190": 42.08,
        "315210": 25.74,
        "315220": 35.28,
        "315240": 32.44,
        "315280": 59.2,
        "315990": 71.62,
        "316110": 56.04,
        "316210": 39.94,
        "316992": 849.82,
        "316998": 36.22,
        "321113": 237.66,
        "321114": 148.82,
        "321211": 401.82,
        "321212": 376.66,
        "321213": 245.02,
        "321214": 727.38,
        "321219": 178.4,
        "321911": 249.1,
        "321912": 112.92,
        "321918": 148.94,
        "321920": 99.7,
        "321991": 516.64,
        "321992": 278.06,
        "321999": 49.76,
        "322110": 413.66,
        "322121": 85.7,
        "322122": 297.04,
        "322130": 194.3,
        "322211": 405.34,
        "322212": 489.3,
        "322219": 160.58,
        "322220": 102.48,
        "322230": 152.74,
        "322291": 266.22,
        "322299": 156.42,
        "323111": 134.48,
        "323113": 152.4,
        "323117": 133.82,
        "323120": 122.16,
        "324110": 68.34,
        "324121": 624.26,
        "324122": 179.36,
        "324191": 267.16,
        "324199": 280.8,
        "325110": 118.64,
        "325120": 173.8,
        "325130": 55.26,
        "325180": 20.9,
        "325193": 714.76,
        "325194": 33.4,
        "325199": 28.48,
        "325211": 56.46,
        "325212": 83.24,
        "325220": 69.18,
        "325311": 274.1,
        "325312": 374.4,
        "325314": 494.34,
        "325320": 81.92,
        "325411": 65.14,
        "325412": 65.74,
        "325413": 258.94,
        "325414": 164.52,
        "325510": 150.98,
        "325520": 238.54,
        "325611": 263.04,
        "325612": 87.38,
        "325613": 266.58,
        "325620": 106.66,
        "325910": 235.6,
        "325920": 147.86,
        "325991": 771.42,
        "325992": 162.44,
        "325998": 55.06,
        "326111": 537.32,
        "326112": 960.16,
        "326113": 334.54,
        "326121": 635.72,
        "326122": 653.74,
        "326130": 601.76,
        "326140": 260.32,
        "326150": 348.74,
        "326160": 1971.98,
        "326191": 290.52,
        "326199": 103.8,
        "326211": 382.34,
        "326212": 763.16,
        "326220": 193.48,
        "326291": 965.32,
        "326299": 102.6,
        "327110": 56.02,
        "327120": 77.6,
        "327211": 567.84,
        "327212": 94.18,
        "327213": 372.64,
        "327215": 107.84,
        "327310": 887.88,
        "327320": 1410.96,
        "327331": 383.86,
        "327332": 359.44,
        "327390": 214.74,
        "327410": 378.22,
        "327420": 136.76,
        "327910": 205.82,
        "327991": 296.04,
        "327992": 165.84,
        "327993": 729.7,
        "327999": 215.58,
        "331110": 40.18,
        "331210": 517.88,
        "331221": 209.26,
        "331222": 144.36,
        "331313": 219.88,
        "331314": 199.5,
        "331315": 160.76,
        "331318": 65.22,
        "331410": 73.48,
        "331420": 72.7,
        "331491": 60.1,
        "331492": 108.66,
        "331511": 138.94,
        "331512": 857.56,
        "331513": 445.6,
        "331523": 202,
        "331524": 549.26,
        "331529": 182.64,
        "332111": 293.52,
        "332112": 371.42,
        "332114": 1286.62,
        "332117": 1732.76,
        "332119": 502.58,
        "332215": 89.46,
        "332216": 40.28,
        "332311": 252.34,
        "332312": 292.08,
        "332313": 124.62,
        "332321": 178.92,
        "332322": 159.82,
        "332323": 139.78,
        "332410": 187.08,
        "332420": 130.1,
        "332431": 253.04,
        "332439": 147.72,
        "332510": 172.46,
        "332613": 173.44,
        "332618": 79.98,
        "332710": 4753.28,
        "332721": 7137.16,
        "332722": 227.96,
        "332811": 434.36,
        "332812": 293.58,
        "332813": 362.72,
        "332911": 132.32,
        "332912": 210.52,
        "332913": 263.16,
        "332919": 201.16,
        "332991": 250.9,
        "332992": 174.56,
        "332993": 104.26,
        "332994": 67.7,
        "332996": 328.64,
        "332999": 58.28,
        "333111": 71.1,
        "333112": 146.3,
        "333120": 71.72,
        "333131": 107.78,
        "333132": 377.44,
        "333241": 87.52,
        "333242": 349.6,
        "333243": 105.64,
        "333244": 175.26,
        "333249": 50.66,
        "333314": 113.8,
        "333316": 110.7,
        "333318": 57,
        "333413": 263.64,
        "333414": 137.32,
        "333415": 126.2,
        "333511": 635.54,
        "333514": 396.5,
        "333515": 131.26,
        "333517": 48.26,
        "333519": 148.46,
        "333611": 219.26,
        "333612": 399.38,
        "333613": 241.78,
        "333618": 207.94,
        "333912": 463.08,
        "333914": 315.02,
        "333921": 503.72,
        "333922": 333.84,
        "333923": 232.08,
        "333924": 156.6,
        "333991": 128.18,
        "333992": 223.14,
        "333993": 286.36,
        "333994": 171.36,
        "333995": 533.1,
        "333996": 388.44,
        "333997": 260.52,
        "333999": 241.24,
        "334111": 247.74,
        "334112": 283.14,
        "334118": 176.2,
        "334210": 155.44,
        "334220": 122.14,
        "334290": 163.16,
        "334310": 141.14,
        "334412": 985.32,
        "334413": 125.24,
        "334416": 381.44,
        "334417": 509.48,
        "334418": 486.26,
        "334419": 143.54,
        "334510": 82.22,
        "334511": 68.68,
        "334512": 64.42,
        "334513": 59.96,
        "334514": 84.7,
        "334515": 48.92,
        "334516": 65.92,
        "334517": 174.04,
        "334519": 38.72,
        "334613": 238.88,
        "334614": 274.24,
        "335110": 90.9,
        "335121": 174.02,
        "335122": 187.3,
        "335129": 126.9,
        "335210": 37.78,
        "335220": 125.28,
        "335311": 95.4,
        "335312": 99.5,
        "335313": 132,
        "335314": 193.62,
        "335911": 292.08,
        "335912": 224.42,
        "335921": 1698.08,
        "335929": 721.82,
        "335931": 95.92,
        "335932": 249.5,
        "335991": 174.64,
        "335999": 107.42,
        "336111": 439.82,
        "336112": 257.74,
        "336120": 281.98,
        "336211": 142.86,
        "336212": 324.62,
        "336213": 832.12,
        "336214": 306.76,
        "336310": 160.2,
        "336320": 129.5,
        "336330": 304.4,
        "336340": 235.88,
        "336350": 246.74,
        "336360": 258.7,
        "336370": 478.96,
        "336390": 171.58,
        "336411": 286.72,
        "336412": 297.66,
        "336413": 323.3,
        "336414": 663.46,
        "336415": 660.26,
        "336419": 663.14,
        "336510": 212.22,
        "336611": 156.12,
        "336612": 221.7,
        "336991": 555.9,
        "336992": 832.52,
        "336999": 321.08,
        "337110": 781.28,
        "337121": 203.04,
        "337122": 99.46,
        "337124": 91.8,
        "337125": 166.4,
        "337127": 128.62,
        "337211": 373.58,
        "337212": 1151.36,
        "337214": 359.44,
        "337215": 174.62,
        "337910": 482.82,
        "337920": 288.46,
        "339112": 103.38,
        "339113": 65,
        "339114": 145.8,
        "339115": 305.84,
        "339116": 1719.32,
        "339910": 112.24,
        "339920": 94.24,
        "339930": 92.74,
        "339940": 69.88,
        "339950": 1052.42,
        "339991": 451,
        "339992": 84.18,
        "339993": 263.5,
        "339994": 321.5,
        "339995": 682.34,
        "339999": 150.68,
        "423110": 276.74,
        "423120": 298.64,
        "423130": 691.38,
        "423140": 769.64,
        "423210": 453.38,
        "423220": 246.64,
        "423310": 280.16,
        "423320": 234.62,
        "423330": 338.92,
        "423390": 233.14,
        "423410": 199.58,
        "423420": 318.7,
        "423430": 327.52,
        "423440": 197.66,
        "423450": 243.04,
        "423460": 339.58,
        "423490": 219.7,
        "423510": 171.84,
        "423520": 221.42,
        "423610": 238.84,
        "423620": 108.68,
        "423690": 184.46,
        "423710": 403.68,
        "423720": 227.6,
        "423730": 460.04,
        "423740": 242.88,
        "423810": 343.18,
        "423820": 328.82,
        "423830": 159.94,
        "423840": 170.02,
        "423850": 189.7,
        "423860": 195.18,
        "423910": 186.58,
        "423920": 250.98,
        "423930": 446.18,
        "423940": 380.72,
        "423990": 231.26,
        "424110": 635.98,
        "424120": 168.38,
        "424130": 182.38,
        "424210": 191.64,
        "424310": 209.16,
        "424320": 289.46,
        "424330": 258.58,
        "424340": 721.86,
        "424410": 1537.84,
        "424420": 378.48,
        "424430": 297.62,
        "424440": 355.1,
        "424450": 327.14,
        "424460": 624.24,
        "424470": 539.56,
        "424480": 983.98,
        "424490": 173.56,
        "424510": 880.44,
        "424520": 523.42,
        "424590": 119.16,
        "424610": 539.1,
        "424690": 139.16,
        "424710": 363.18,
        "424720": 319.66,
        "424810": 689.44,
        "424820": 444.76,
        "424910": 306.22,
        "424920": 426.28,
        "424930": 688.98,
        "424940": 572.5,
        "424950": 292.2,
        "424990": 154.4,
        "425110": 573.3,
        "425120": 2871.8,
        "441110": 5158.94,
        "441120": 4184.76,
        "441210": 692.12,
        "441222": 929.28,
        "441228": 508.74,
        "441310": 1683.6,
        "441320": 2506.6,
        "442110": 2690.52,
        "442210": 2837.22,
        "442291": 2729.34,
        "442299": 1051.56,
        "443141": 1881.3,
        "443142": 840.1,
        "444110": 2862.02,
        "444120": 3068.4,
        "444130": 4343.72,
        "444190": 815.42,
        "444210": 1824.06,
        "444220": 1774.78,
        "445110": 4409.16,
        "445120": 8827.94,
        "445210": 1339.68,
        "445220": 1869.6,
        "445230": 892.78,
        "445291": 3170.54,
        "445292": 1713.78,
        "445299": 670.76,
        "445310": 3227.52,
        "446110": 4429.6,
        "446120": 3455.6,
        "446130": 2957.96,
        "446191": 2166.54,
        "446199": 1536.48,
        "447110": 10831.54,
        "447190": 2727.88,
        "448110": 3031.98,
        "448120": 4754.7,
        "448130": 2280.96,
        "448140": 4436.3,
        "448150": 913.06,
        "448190": 740.24,
        "448210": 2756.14,
        "448310": 3071.06,
        "448320": 1528.84,
        "451110": 855.6,
        "451120": 1432.84,
        "451130": 1220.74,
        "451140": 1388.8,
        "451211": 4463.44,
        "451212": 914.06,
        "452210": 7512.76,
        "452311": 2466.92,
        "452319": 2642.72,
        "453110": 6011.3,
        "453210": 2098.54,
        "453220": 1032.92,
        "453310": 714.92,
        "453910": 2695.22,
        "453920": 1966.94,
        "453930": 1877.44,
        "453991": 2747.58,
        "453998": 550.64,
        "454110": 1061.42,
        "454210": 2360.7,
        "454310": 1086.18,
        "454390": 813.72,
        "481111": 615.18,
        "481112": 476.46,
        "481211": 569.88,
        "481212": 356.94,
        "481219": 1323.56,
        "482111": 542.16,
        "482112": 406.62,
        "483111": 610.26,
        "483112": 560.02,
        "483113": 340.84,
        "483114": 316.58,
        "483211": 338.34,
        "483212": 367.02,
        "484110": 3091.5,
        "484121": 3334.48,
        "484122": 1990.4,
        "484210": 2000.36,
        "484220": 763.18,
        "484230": 432.3,
        "485111": 472.54,
        "485112": 468.4,
        "485113": 462.3,
        "485119": 372.64,
        "485210": 585.96,
        "485310": 956.76,
        "485320": 981.12,
        "485410": 1887.84,
        "485510": 1647.28,
        "485991": 1141.36,
        "485999": 897.1,
        "486110": 875.52,
        "486210": 722.82,
        "486910": 596.38,
        "486990": 672.96,
        "487110": 252.62,
        "487210": 423.38,
        "487990": 456.24,
        "488111": 1774.26,
        "488119": 354.72,
        "488190": 653.34,
        "488210": 470.46,
        "488310": 314.72,
        "488320": 660.22,
        "488330": 516.24,
        "488390": 624.32,
        "488410": 1731.16,
        "488490": 420.16,
        "488510": 2571.72,
        "488991": 1321.34,
        "488999": 411.86,
        "491110": 542.16,
        "492110": 2171.32,
        "492210": 938.56,
        "493110": 1983.64,
        "493120": 493.44,
        "493130": 580.6,
        "493190": 626.3,
        "511110": 1555.32,
        "511120": 181.2,
        "511130": 144.1,
        "511140": 269.56,
        "511191": 686.36,
        "511199": 155.16,
        "511210": 948.58,
        "512110": 637.28,
        "512120": 377.54,
        "512131": 761,
        "512132": 591.66,
        "512191": 323.76,
        "512199": 207.76,
        "512230": 386.6,
        "512240": 1100.82,
        "512250": 384.44,
        "512290": 433.42,
        "515111": 538.82,
        "515112": 705.02,
        "515120": 958.1,
        "515210": 424.88,
        "517311": 1011.56,
        "517312": 934.44,
        "517410": 557.84,
        "517911": 741.56,
        "517919": 528.44,
        "518210": 639.28,
        "519110": 352.64,
        "519120": 539.06,
        "519130": 115.68,
        "519190": 663.4,
        "521110": 371.6,
        "522110": 4482.94,
        "522120": 295.72,
        "522130": 2932.1,
        "522190": 464.7,
        "522210": 837.72,
        "522220": 673.96,
        "522291": 1588.72,
        "522292": 1299.86,
        "522293": 390.28,
        "522294": 180.72,
        "522298": 191.34,
        "522310": 955.22,
        "522320": 501.88,
        "522390": 1906.46,
        "523110": 374.82,
        "523120": 1233.36,
        "523130": 364.7,
        "523140": 381.44,
        "523210": 413.86,
        "523910": 1004.78,
        "523920": 1954.24,
        "523930": 2085.26,
        "523991": 651.98,
        "523999": 331.78,
        "524113": 671.22,
        "524114": 824.28,
        "524126": 509.26,
        "524127": 1198.88,
        "524128": 398.4,
        "524130": 640.8,
        "524210": 5450.84,
        "524291": 960.24,
        "524292": 1088.14,
        "524298": 480.8,
        "525110": 406.62,
        "525120": 650.58,
        "525190": 650.58,
        "525910": 542.16,
        "525920": 406.62,
        "525990": 203.3,
        "531110": 1461.14,
        "531120": 513.46,
        "531130": 1357.98,
        "531190": 508.58,
        "531210": 1502.62,
        "531311": 1541.52,
        "531312": 948.52,
        "531320": 2455.12,
        "531390": 960.42,
        "532111": 1074.76,
        "532112": 504.26,
        "532120": 520.32,
        "532210": 575.72,
        "532281": 323.88,
        "532282": 666.02,
        "532283": 573.04,
        "532284": 257.98,
        "532289": 561.98,
        "532310": 2136.94,
        "532411": 271.08,
        "532412": 554.24,
        "532420": 365.7,
        "532490": 255.72,
        "533110": 573.42,
        "541110": 1787.74,
        "541120": 3252.92,
        "541191": 2104.22,
        "541199": 809.48,
        "541211": 1764.42,
        "541213": 4529.68,
        "541214": 2811.88,
        "541219": 1912.24,
        "541310": 2228.44,
        "541320": 382.24,
        "541330": 921.22,
        "541340": 1540.2,
        "541350": 1278.4,
        "541360": 316.46,
        "541370": 601.64,
        "541380": 271.58,
        "541410": 2045.86,
        "541420": 742.36,
        "541430": 602.08,
        "541490": 544.8,
        "541511": 2437.12,
        "541512": 1392.18,
        "541513": 1926.54,
        "541519": 3660.24,
        "541611": 2411.06,
        "541612": 813.72,
        "541613": 4030.84,
        "541614": 524.2,
        "541618": 3146.36,
        "541620": 1818.44,
        "541690": 729.22,
        "541713": 2513.86,
        "541714": 315.7,
        "541715": 325.42,
        "541720": 370.64,
        "541810": 6232.12,
        "541820": 1665.56,
        "541830": 2293.82,
        "541840": 547.42,
        "541850": 442.44,
        "541860": 1526.4,
        "541870": 385.46,
        "541890": 1196.64,
        "541910": 896.48,
        "541921": 1220.34,
        "541922": 1062.64,
        "541930": 772.04,
        "541940": 886.96,
        "541990": 591.36,
        "551111": 1897.06,
        "551112": 918.58,
        "551114": 2861.18,
        "561110": 1373.24,
        "561210": 1003.72,
        "561311": 278.34,
        "561312": 1726.92,
        "561320": 1439.66,
        "561330": 1014.82,
        "561410": 476.6,
        "561421": 604.74,
        "561422": 731.86,
        "561431": 1307.02,
        "561439": 747.82,
        "561440": 799.98,
        "561450": 398.92,
        "561491": 2191.8,
        "561492": 837.86,
        "561499": 883.68,
        "561510": 6253.08,
        "561520": 1613.4,
        "561591": 764.8,
        "561599": 241.8,
        "561611": 569.84,
        "561612": 876.58,
        "561613": 4400.46,
        "561621": 1028.54,
        "561622": 1436.16,
        "561710": 1600.02,
        "561720": 1158,
        "561730": 834.5,
        "561740": 677.14,
        "561790": 623.34,
        "561910": 352.82,
        "561920": 272.56,
        "561990": 407.94,
        "562111": 648.02,
        "562112": 650.36,
        "562119": 438.36,
        "562211": 246.92,
        "562212": 362.5,
        "562213": 335.06,
        "562219": 614.58,
        "562910": 435.56,
        "562920": 838.32,
        "562991": 693.64,
        "562998": 434.52,
        "611110": 108.44,
        "611210": 361.44,
        "611310": 141.44,
        "611410": 483.6,
        "611420": 766.12,
        "611430": 1808.58,
        "611511": 534.12,
        "611512": 650.42,
        "611513": 439.32,
        "611519": 192.36,
        "611610": 562.88,
        "611620": 404.84,
        "611630": 867.96,
        "611691": 1052.4,
        "611692": 1533.96,
        "611699": 596.2,
        "611710": 780.6,
        "621111": 1131.18,
        "621112": 1012.76,
        "621210": 2383.52,
        "621310": 5166.08,
        "621320": 3933.04,
        "621330": 2385.88,
        "621340": 954.02,
        "621391": 1635.82,
        "621399": 444.22,
        "621410": 657.58,
        "621420": 1068.74,
        "621491": 1321.58,
        "621492": 1925.66,
        "621493": 1202.92,
        "621498": 1391.74,
        "621511": 551.22,
        "621512": 382.6,
        "621610": 1913.72,
        "621910": 1378.6,
        "621991": 433.9,
        "621999": 628.24,
        "622110": 1608,
        "622210": 278.98,
        "622310": 296.4,
        "623110": 1374.68,
        "623210": 2142.74,
        "623220": 649.9,
        "623311": 2736.02,
        "623312": 1654.72,
        "623990": 444.92,
        "624110": 843.94,
        "624120": 1325.28,
        "624190": 538.98,
        "624210": 1116.34,
        "624221": 570.38,
        "624229": 952.3,
        "624230": 515.34,
        "624310": 674.54,
        "624410": 1919.76,
        "711110": 268.06,
        "711120": 256.2,
        "711130": 253.32,
        "711190": 391.96,
        "711211": 173.36,
        "711212": 314.92,
        "711219": 174.9,
        "711310": 84.04,
        "711320": 94.9,
        "711410": 245.14,
        "711510": 221.58,
        "712110": 310.02,
        "712120": 674.38,
        "712130": 245.5,
        "712190": 262.34,
        "713110": 630.4,
        "713120": 724.82,
        "713210": 607.36,
        "713290": 316.34,
        "713910": 2801.22,
        "713920": 417.76,
        "713930": 1177.36,
        "713940": 623.78,
        "713950": 776.28,
        "713990": 133,
        "721110": 1096.34,
        "721120": 774.98,
        "721191": 2148.18,
        "721199": 505.82,
        "721211": 1272.96,
        "721214": 409.46,
        "721310": 394.8,
        "722310": 1766.06,
        "722320": 3847.98,
        "722330": 623.6,
        "722410": 2079.3,
        "722511": 4692.94,
        "722513": 2879.5,
        "722514": 2821.48,
        "722515": 1629.6,
        "811111": 2706.26,
        "811112": 1307.5,
        "811113": 2511.52,
        "811118": 454.32,
        "811121": 1404.06,
        "811122": 1077.8,
        "811191": 2474.4,
        "811192": 1506.84,
        "811198": 554.8,
        "811211": 606.42,
        "811212": 1029.14,
        "811213": 697.68,
        "811219": 453.76,
        "811310": 378.56,
        "811411": 482.22,
        "811412": 637.74,
        "811420": 776.62,
        "811430": 758.24,
        "811490": 440.48,
        "812111": 2692.48,
        "812112": 2076.74,
        "812113": 3312.92,
        "812191": 1298.24,
        "812199": 788.16,
        "812210": 1335.28,
        "812220": 737.88,
        "812310": 929.72,
        "812320": 560.68,
        "812331": 340.98,
        "812332": 370.38,
        "812910": 844.18,
        "812921": 968.4,
        "812922": 688.2,
        "812930": 1683.22,
        "812990": 296.6,
        "813110": 250.22,
        "813211": 1171.42,
        "813212": 1878.54,
        "813219": 1423.58,
        "813311": 851.96,
        "813312": 1207.1,
        "813319": 431.78,
        "813410": 358.52,
        "813910": 447.16,
        "813920": 350.68,
        "813930": 295.72,
        "813940": 361.44,
        "813990": 1244.06,
        "814110": 650.58,
        "921110": 406.62,
        "921120": 325.3,
        "921130": 232.36,
        "921140": 1084.3,
        "921150": 361.44,
        "921190": 232.36,
        "922110": 361.44,
        "922120": 191.34,
        "922130": 406.62,
        "922140": 325.3,
        "922150": 464.7,
        "922160": 406.62,
        "922190": 406.62,
        "923110": 361.44,
        "923120": 232.36,
        "923130": 216.86,
        "923140": 1084.3,
        "924110": 406.62,
        "924120": 216.86,
        "925110": 813.22,
        "925120": 406.62,
        "926110": 191.34,
        "926120": 203.3,
        "926130": 216.86,
        "926140": 325.3,
        "926150": 147.86,
        "927110": 650.58,
        "928110": 250.22,
        "928120": 191.34,
    }

    n_dup17 = 2
    f = io.open("example_data_2017.txt", "w")
    f.write("|".join(["TEXT", "NAICS", "SAMPLE_WEIGHT"]) + "\n")
    for tup in combined17_tups:
        # Output duplicate observations to assist with illustrating cross-validation
        for i in range(n_dup17):
            f.write("|".join([tup[1], tup[0], format_weight(weights17[tup[0]], n_dup17)]) + "\n")
    f.close()

    print("Sample size:            {}".format(len(combined17_tups) * n_dup17))
    print("Number of sectors:      {}".format(len(set(get_sector(tup[0]) for tup in combined17_tups))))
    print("Number of NAICS codes:  {}".format(len(set(tup[0] for tup in combined17_tups))))
    print("")

    # 2022 data WITHOUT sample weights
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@    2022 data WITHOUT sample weights    @@@@")
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("")

    index22_df = pd.read_excel("2022_NAICS_Index_File.xlsx")
    index22_tups = []
    for i in range(len(index22_df)):
        naics_temp = index22_df.at[i, "NAICS22"]
        descr_temp = index22_df.at[i, "INDEX ITEM DESCRIPTION"]
        if not (pd.isna(naics_temp) or naics_temp == "******" or pd.isna(descr_temp)):
            index22_tups.append((format_naics(naics_temp), format_descr(descr_temp)))

    codes22_df = pd.read_excel("6-digit_2022_Codes.xlsx")
    codes22_tups = []
    for i in range(len(codes22_df)):
        naics_temp = codes22_df.at[i, "2022 NAICS Code"]
        descr_temp = codes22_df.at[i, "2022 NAICS Title"]
        if not (pd.isna(naics_temp) or pd.isna(descr_temp)):
            codes22_tups.append((format_naics(naics_temp), format_descr(descr_temp)))

    combined22_tups = sorted(set(index22_tups + codes22_tups))

    n_dup22 = 2
    f = io.open("example_data_2022.txt", "w")
    f.write("|".join(["TEXT", "NAICS"]) + "\n")
    for tup in combined22_tups:
        # Output duplicate observations to assist with illustrating cross-validation
        for i in range(n_dup22):
            f.write("|".join([tup[1], tup[0]]) + "\n")
    f.close()

    print("Sample size:            {}".format(len(combined22_tups) * n_dup22))
    print("Number of sectors:      {}".format(len(set(get_sector(tup[0]) for tup in combined22_tups))))
    print("Number of NAICS codes:  {}".format(len(set(tup[0] for tup in combined22_tups))))
    print("")

    return

if __name__ == "__main__":
    main()
